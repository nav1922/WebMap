"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
<<<<<<< HEAD
exports.maybeAddIdToDocuments = exports.indexInformation = void 0;
=======
exports.prepareDocs = exports.indexInformation = void 0;
>>>>>>> 133cd24d00c503c2f82710b8cbb50ea1868a2272
async function indexInformation(db, name, options) {
    if (options == null) {
        options = {};
    }
    // If we specified full information
    const full = options.full == null ? false : options.full;
    // Get the list of indexes of the specified collection
    const indexes = await db.collection(name).listIndexes(options).toArray();
    if (full)
        return indexes;
    const info = {};
    for (const index of indexes) {
        info[index.name] = Object.entries(index.key);
    }
    return info;
}
exports.indexInformation = indexInformation;
<<<<<<< HEAD
function maybeAddIdToDocuments(coll, docOrDocs, options) {
=======
function prepareDocs(coll, docs, options) {
>>>>>>> 133cd24d00c503c2f82710b8cbb50ea1868a2272
    const forceServerObjectId = typeof options.forceServerObjectId === 'boolean'
        ? options.forceServerObjectId
        : coll.s.db.options?.forceServerObjectId;
    // no need to modify the docs if server sets the ObjectId
    if (forceServerObjectId === true) {
<<<<<<< HEAD
        return docOrDocs;
    }
    const transform = (doc) => {
=======
        return docs;
    }
    return docs.map(doc => {
>>>>>>> 133cd24d00c503c2f82710b8cbb50ea1868a2272
        if (doc._id == null) {
            doc._id = coll.s.pkFactory.createPk();
        }
        return doc;
<<<<<<< HEAD
    };
    return Array.isArray(docOrDocs) ? docOrDocs.map(transform) : transform(docOrDocs);
}
exports.maybeAddIdToDocuments = maybeAddIdToDocuments;
=======
    });
}
exports.prepareDocs = prepareDocs;
>>>>>>> 133cd24d00c503c2f82710b8cbb50ea1868a2272
//# sourceMappingURL=common_functions.js.map